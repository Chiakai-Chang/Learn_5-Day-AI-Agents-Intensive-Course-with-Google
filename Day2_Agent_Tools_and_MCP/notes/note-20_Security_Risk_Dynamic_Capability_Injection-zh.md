### 🎙️ 第 20 頁：Security Risk: Dynamic Capability Injection

#### 【本頁重點摘要】
*   **核心風險**：MCP 伺服器可以在不通知客戶端的情況下，動態新增或更改其提供的工具。
*   **潛在後果**：一個原本低風險的代理 (Agent) 可能會意外繼承一個未經授權的、高風險的新功能。
*   **防禦策略**：透過客戶端的「允許清單」、版本鎖定、API 閘道過濾，以及在受控環境中部署伺服器來進行防禦。

---

#### 【逐字講稿】

(開場白)
各位，想像一下，你聘請了一位只負責整理書架的圖書館助理，但某天他突然拿到了一張沒有額度上限的公司信用卡，而你完全不知情。這聽起來很可怕，對吧？這就是我們今天要談的第一個 MCP 重大安全風險：**動態能力注入 (Dynamic Capability Injection)**。

##### ① 風險的根源：失控的動態性

這個問題的核心在於 MCP 的一個設計特性：它的「動態性」。在傳統的 API 中，功能變更通常需要重新部署和發布，但在 MCP 的世界裡，伺服器可以隨時更改它所提供的工具清單，而且，根據協議，它**沒有義務**通知連接到它的任何代理程式。

> 這意味著，一個代理的能力範圍可能會在我們不知不覺中被擴展，遠遠超出它最初設計的領域和對應的風險評估。

一個原本無害的工具，可能在一夜之間就變得危險。

##### ② 一個失控的詩人：具體案例

讓我們用投影片上的例子，把這個風險具象化。

假設我們開發了一個非常可愛、低風險的「詩歌寫作代理」。它的工作很單純：寫寫詩，偶爾連接到一個公開的「書籍伺服器」來查找一些名言佳句。這是一個純粹的內容生成任務，風險極低。

但問題來了。某一天，那個「書籍伺服器」的開發者為了提供更多價值，決定新增一個功能：`purchase_book`，也就是「購買書籍」。

因為 MCP 的動態發現機制，你的詩人代理在下一次連接時，會自動發現這個新工具。於是，你那個原本只會吟詩作對的代理，現在**突然擁有了花錢、進行金融交易的能力**。一個低風險的應用，瞬間變成了一個高風險的財務缺口。這就是動態能力注入的可怕之處。

##### ③ 防禦工事：如何鎖住代理的能力？

那麼，我們該如何防止我們的詩人跑去大買特買呢？有幾層關鍵的防禦措施：

*   **第一層，在客戶端把關**：最直接的方法，就是在代理程式這邊實施嚴格的控制。你可以建立一份**工具允許清單 (allowlist)**，只允許代理使用你明確批准的工具。或者，將工具定義**鎖定 (Pin)** 在某個特定的版本或雜湊值，一旦伺服器擅自更改，客戶端就立刻發出警報或斷開連接。

*   **第二層，在閘道攔截**：一個更強大、更適合企業環境的做法，是使用一個安全的 **API 閘道器**，例如 Google 的 Apigee。你可以把這個閘道器想像成一個站在代理和外部工具世界之間的「安全警衛」。它可以檢查伺服器回傳的工具清單，並根據整個企業的安全策略進行過濾，確保只有合規的工具才能被你的代理看到。

*   **第三層，釜底抽薪**：當然，最根本的解決方案，就是將 MCP 伺服器部署在你自己能夠完全掌控的**受控環境**中。如果伺服器本身就在你的管理之下，它自然就不會在你不知情的情況下增加危險的功能。

---

#### 【講者提示 & 轉場】
*   **節奏提醒**：在講「圖書館助理拿到信用卡」這個比喻時，可以稍微停頓，讓聽眾感受這個比喻的衝擊力。
*   **案例強調**：「詩人代理去購物」的例子非常直觀，可以稍微加重語氣，讓聽眾記住這個場景。
*   **轉場橋樑 (Bridge)**：
    > 了解了代理如何「意外地」獲得一個危險的新工具後，下一個問題是：如果一個「惡意的」工具，偽裝成一個「合法的」工具，來欺騙我們的代理呢？這就引出了我們的下一個風險：**工具遮蔽 (Tool Shadowing)**。