### 🎙️ 第 23 頁：Memory_Retrieval_Strategies

#### 【本頁重點摘要】
*   記憶檢索的目標是為當前對話找到最相關的記憶，而不僅僅是基於向量相似度。
*   高效的檢索策略會綜合考量記憶的「相關性」、「新近性」和「重要性」等多個維度。
*   針對高精確度需求，可採用查詢重寫或重新排序等進階技術，但需權衡其帶來的延遲。

---

#### 【逐字講稿】

(開場白)
好的，我們已經了解了記憶是如何生成和整合的。現在，有了這些寶貴的記憶庫，下一個關鍵問題就是：我們該如何有效地「找回」它們？這頁投影片，我們將深入探討記憶檢索的策略，也就是如何從龐大的記憶中，精準地找到當前對話最需要的資訊。

##### ① 檢索的目標與挑戰
記憶檢索的核心目標，是為當前的對話找到**最相關、最恰當**的記憶。這聽起來簡單，但實際上，如果只是單純地依賴向量搜尋來判斷「相關性」，往往是不夠的。因為單純的相似度分數，可能會找出概念上相似但卻過時或不重要的記憶，反而會混淆模型，甚至降低回應品質。

> 想像一下，你問一個 AI 助理：「我上次說想買什麼書？」如果它只根據「書」這個關鍵字，給你推薦了三年前你隨口提過的一本舊書，而不是你上週才熱烈討論的新書，那體驗肯定不好。

##### ② 多維度評分，提升檢索精準度
因此，先進的記憶系統會超越單一的向量相似度，從多個維度來評估和排序潛在的記憶。這就像我們人類回憶事情一樣，會綜合考量：

*   **相關性 (Semantic Similarity)**：這條記憶與當前對話在概念上有多接近？這是最基本的判斷。
*   **新近性 (Recency)**：這條記憶是多久以前建立的？最近發生的事情，通常對當前對話更有意義。
*   **重要性 (Importance)**：這條記憶整體而言有多關鍵？有些記憶可能不常被提及，但其重要性卻是長期的，例如用戶的個人偏好或核心目標。

最有效的策略，就是將這三個維度的分數結合起來，進行**混合式評分**，以確保檢索到的記憶既相關又實用。

##### ③ 進階檢索技術：精準但高延遲
對於那些對精確度要求極高的應用場景，我們還可以採用一些更為精密的進階技術來優化檢索結果。這些技術雖然能顯著提升準確性，但通常會伴隨著較高的計算成本和延遲：

*   **查詢重寫 (Query Rewriting)**：利用另一個 LLM 來改寫或擴展用戶的原始查詢。例如，將一個模糊的提問改寫成更精確的搜尋語句，或者將單一查詢擴展為多個相關查詢，以捕捉主題的不同面向。這能讓初始搜尋的品質大幅提升。
*   **重新排序 (Reranking)**：首先透過向量搜尋快速檢索出一批候選記憶（例如前 50 條），然後再使用一個 LLM 對這小範圍的結果進行更細緻的評估和重新排序，從中選出最優的幾條。

這些技術就像是為記憶檢索加上了「精修」環節，確保最終呈現給模型的記憶是經過層層篩選的黃金資訊。然而，由於它們涉及額外的 LLM 呼叫，會增加處理時間，因此在即時性要求高的場景中需要謹慎使用。

---

#### 【講者提示 & 轉場】
*   **節奏提醒**：在解釋完多維度評分和進階技術後，可以強調「平衡」的重要性，即在精準度和效率之間找到最佳點。
*   **補充案例**：可以舉例說明，在客服場景中，新近性可能比重要性更關鍵；而在個人助理場景中，用戶偏好（重要性）則可能優先於新近性。
*   **轉場橋樑 (Bridge)**：
    > 了解了如何「找」記憶之後，下一個問題自然就是：「什麼時候該找？」是每次對話都主動載入，還是等到需要時再檢索？下一頁，我們將探討記憶檢索的「時機」選擇，也就是「主動式」與「反應式」檢索策略的權衡。