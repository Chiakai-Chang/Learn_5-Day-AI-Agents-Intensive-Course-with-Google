### 🎙️ 第 22 頁：Memory-as-a-Tool_Pattern

#### 【本頁重點摘要】
*   這是一種更進階的模式，讓代理人 (Agent) 自己決定何時要建立或取回記憶。
*   作法是將記憶的生成 (`create_memory`) 與檢索 (`search_memory`) 功能，包裝成「工具」供代理人使用。
*   責任從固定的觸發機制，轉移到由代理人根據對話上下文，自主判斷何時呼叫這些工具。
*   這種模式比每一輪都觸發記憶更有效率、更穩健，也讓代理人的行為更具目的性。

---

#### 【逐字講稿】

(開場白)
好，我們剛剛討論了幾種觸發記憶生成的時機，比如在對話結束時，或是每隔幾輪就觸發一次。但這些都屬於比較「被動」或「固定」的策略。現在，我們要介紹一個更進階、更智慧的模式，叫做「Memory-as-a-Tool」，也就是「將記憶視為一種工具」。

##### ① 什麼是「將記憶視為工具」？
這個概念的核心，是賦予代理人**主動權**。我們不再死板地規定它「何時」該去記憶或回想，而是讓它自己**決定**。

> 這就像從一個只會「被動記錄」的學徒，進化成一個懂得「主動思考」的專家。專家不會把所有聽到的話都記下來，他會判斷：「嗯，這段資訊很重要，我得記下來」，或者「這個問題我需要查一下之前的筆記」。

在這個模式下，代理人就是那個專家。

##### ② 它是如何運作的？
運作方式非常巧妙。我們會把「建立記憶」和「搜尋記憶」這兩個動作，包裝成代理人可以呼叫的工具，就像它呼叫計算機或網路搜尋一樣。

*   例如，我們可以建立一個叫做 `create_memory` 的工具，和一個 `search_memory` 的工具。
*   當對話進行時，代理人的大腦，也就是 LLM，會根據它對工具的描述以及當前的對話內容，來自主判斷：「現在，是時候呼叫 `create_memory` 工具來記住用戶剛剛提到的偏好了」，或者「用戶問了一個跟上次討論相關的問題，我應該呼叫 `search_memory` 工具來找回相關記憶。」

這意味著，**判斷「什麼資訊有意義」的責任，從外部的記憶體管理器轉移到了代理人本身**。它變得更加自主和智慧。

##### ③ 這種模式有什麼好處？
主要有三大好處：

*   **更有效率 (Efficient)**：代理人只在它認為必要的時候，才執行昂貴的記憶操作，而不是每一輪都盲目地執行，這大大節省了成本和延遲。
*   **更穩健 (Robust)**：因為決策是基於當前的上下文，所以更加精準，避免了在不相關的時候存取記憶，反而造成干擾。
*   **更具目的性 (Deliberate)**：代理人的行為不再是機械式的，而是有意識、有目的地去管理和使用它的知識庫。

正如我們在原始資料中看到的，開發者可以透過 ADK 這樣的框架，將記憶生成的程式碼包裝成一個工具，讓代理人決定何時調用它，將整個對話內容交給 Memory Bank 進行提取和整合。甚至可以做到更精細，讓代理人自己從對話中提取出關鍵事實，然後再呼叫工具，只將這個精煉過的事實存入記憶庫。

---

#### 【講者提示 & 轉場】
*   **節奏提醒**：講到「責任轉移」時可以加重語氣，這是這個模式的核心思想——賦予代理人更大的自主權。
*   **補充案例**：可以舉例，一個旅遊規劃代理人，在用戶提到「我對歷史古蹟很有興趣」時，它會自主決定呼叫 `create_memory` 工具記下這個偏好。當用戶後來說「幫我推薦一些景點」時，它又會自主呼叫 `search_memory` 工具，並把「歷史古蹟」作為關鍵字去搜尋。
*   **轉場橋樑 (Bridge)**：
    > 透過「Memory-as-a-Tool」，我們的代理人學會了「何時」去存取記憶。但這引出了下一個關鍵問題：當它決定要找回記憶時，系統應該「如何」從龐大的記憶庫中，精準地找出最相關的資訊呢？這就是我們下一頁要探討的——記憶檢索的策略。